<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.280">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2023-01-22">

<title>Introduction (week 1, part 3)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="chap1_files/libs/clipboard/clipboard.min.js"></script>
<script src="chap1_files/libs/quarto-html/quarto.js"></script>
<script src="chap1_files/libs/quarto-html/popper.min.js"></script>
<script src="chap1_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="chap1_files/libs/quarto-html/anchor.min.js"></script>
<link href="chap1_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="chap1_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="chap1_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="chap1_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="chap1_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Introduction<br>(week 1, part 3)</h1>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">22 Jan 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<!-- typically renders in docs/ dir  -->
<section id="books" class="level2">
<h2 class="anchored" data-anchor-id="books">books</h2>
<ul>
<li>ESL and ADA cover very similar material</li>
<li>both compare linear regression and nearest-neighbour methods as opposite ends of a complexity spectrum</li>
<li>ESL has more on dimensionality</li>
</ul>
</section>
<section id="fishers-irises" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="fishers-irises">Fisher’s irises</h2>
<ul>
<li>Canadian content (irises of the Gaspé peninsula) <span class="citation" data-cites="fisherUse1936">(<a href="#ref-fisherUse1936" role="doc-biblioref">Fisher 1936</a>)</span></li>
<li>Fisher was a eugenist (!) <span class="citation" data-cites="bodmeroutstanding2021">(<a href="#ref-bodmeroutstanding2021" role="doc-biblioref">Bodmer et al. 2021</a>)</span></li>
<li>multiple versions of the data set, with errors … <span class="citation" data-cites="bezdekWill1999">(<a href="#ref-bezdekWill1999" role="doc-biblioref">Bezdek et al. 1999</a>)</span></li>
<li>alternative: <a href="https://allisonhorst.github.io/palmerpenguins/">Palmer penguins dataset</a></li>
</ul>
<div class="no-row-height column-margin column-container"><div id="ref-fisherUse1936" class="csl-entry" role="doc-biblioentry">
Fisher, R. A. 1936. <span>“The <span>Use</span> of <span>Multiple Measurements</span> in <span>Taxonomic Problems</span>.”</span> <em>Annals of Eugenics</em> 7 (2): 179–88. <a href="https://doi.org/10.1111/j.1469-1809.1936.tb02137.x">https://doi.org/10.1111/j.1469-1809.1936.tb02137.x</a>.
</div><div id="ref-bodmeroutstanding2021" class="csl-entry" role="doc-biblioentry">
Bodmer, Walter, R. A. Bailey, Brian Charlesworth, Adam Eyre-Walker, Vernon Farewell, Andrew Mead, and Stephen Senn. 2021. <span>“The Outstanding Scientist, <span>R</span>.<span>A</span>. <span>Fisher</span>: His Views on Eugenics and Race.”</span> <em>Heredity</em> 126 (4): 565–76. <a href="https://doi.org/10.1038/s41437-020-00394-6">https://doi.org/10.1038/s41437-020-00394-6</a>.
</div><div id="ref-bezdekWill1999" class="csl-entry" role="doc-biblioentry">
Bezdek, J. C., J. M. Keller, R. Krishnapuram, L. I. Kuncheva, and N. R. Pal. 1999. <span>“Will the Real Iris Data Please Stand Up?”</span> <em>IEEE Transactions on Fuzzy Systems</em> 7 (3): 368–69. <a href="https://doi.org/10.1109/91.771092">https://doi.org/10.1109/91.771092</a>.
</div></div></section>
<section id="linear-models" class="level2">
<h2 class="anchored" data-anchor-id="linear-models">linear models</h2>
<ul>
<li>can write out as <span class="math inline">\(\hat Y = \hat \beta_0 + \sum X_j \hat \beta_j\)</span></li>
<li>go almost immediately to <span class="math inline">\(\hat Y = X^{\top} \hat \beta\)</span> or <span class="math inline">\(\left&lt;X, \beta\right&gt;\)</span> or <span class="math inline">\(\mathbf X \beta\)</span></li>
<li><span class="math inline">\(\mathbf X\)</span> is the <em>model matrix</em> (sometimes “design matrix”)</li>
<li>usually includes an intercept column</li>
<li>can contain <em>any</em> (precomputed) functions of input variables</li>
<li>input vars (directly measured) <span class="math inline">\(\to\)</span> predictor vars (transformations, basis expansions, etc.)</li>
<li>1D examples</li>
</ul>
</section>
<section id="least-squares" class="level2">
<h2 class="anchored" data-anchor-id="least-squares">least squares</h2>
<ul>
<li>choose L2 norm (p-norm = <span class="math inline">\(\left( \sum |x|^p \right)^{1/p}\)</span>)</li>
<li><span class="math inline">\(\sum_i (Y_i - X_i \beta)^2\)</span></li>
<li>equivalent to <span class="math inline">\((\mathbf y-\mathbf X\beta)^\top (\mathbf y-\mathbf X\beta)\)</span></li>
<li>differentiate and solve: <span class="math inline">\(\hat \beta = (\mathbf X^\top\mathbf X)^{-1} \mathbf X^\top \mathbf y\)</span></li>
<li><strong>hat matrix</strong>: <span class="math display">\[
\begin{split}
\hat x  = H \mathbf y&amp; =  \mathbf X\hat \beta \\
&amp; = \mathbf X(\mathbf X^\top\mathbf X)^{-1} \mathbf X^\top \mathbf y\\
H &amp;  = \mathbf X(\mathbf X^\top\mathbf X)^{-1} \mathbf X^\top
\end{split}
\]</span></li>
<li>regression as a <em>linear filter</em></li>
<li>cf.&nbsp;explicit expression in ADA 1.52</li>
</ul>
</section>
<section id="regression-nuts-and-bolts" class="level2">
<h2 class="anchored" data-anchor-id="regression-nuts-and-bolts">regression: nuts and bolts</h2>
<ul>
<li>never do naive linear algebra!
<ul>
<li><code>fortunes::fortune("SLOOOOW")</code></li>
</ul></li>
<li>R: QR decomp with Householder rotations
<ul>
<li>see: <a href="https://github.com/wch/r-source/blob/79298c499218846d14500255efd622b5021c10ec/src/library/stats/src/lm.c">lm.c</a>, <a href="https://github.com/wch/r-source/blob/79298c499218846d14500255efd622b5021c10ec/src/appl/dqrls.f">dqlrs</a>, <a href="https://github.com/wch/r-source/blob/79298c499218846d14500255efd622b5021c10ec/src/appl/dqrdc2.f">dqrdc2</a> (<a href="https://github.com/wch/r-source/blob/2c986d4bcd267202c240ebb4300322d788033303/src/appl.f/dqrdc2.f">from the beginning</a>)</li>
</ul></li>
<li>Julia ???</li>
<li>will dig into computational details a bit next week (?)</li>
</ul>
</section>
<section id="regression-as-classification" class="level2">
<h2 class="anchored" data-anchor-id="regression-as-classification">regression as classification</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../pix/boundary1.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">fig2.1</figcaption><p></p>
</figure>
</div>
<ul>
<li>slightly weird</li>
<li>looseness of “classification” vs “regression”
<ul>
<li>should probably use <em>discriminant analysis</em> here</li>
<li>or logistic regression</li>
</ul></li>
</ul>
</section>
<section id="nearest-neighbor" class="level2">
<h2 class="anchored" data-anchor-id="nearest-neighbor">nearest-neighbor</h2>
<ul>
<li><span class="math inline">\(\frac{1}{k} \sum_{x_i \in N_k(x)} y_i\)</span></li>
<li>also a linear smoother: columns of <span class="math inline">\(\mathbf X\)</span> are <span class="math inline">\(1/k \times\)</span> <em>indicator variables</em>: <span class="math inline">\((x_i \in N_k(x))\)</span> and the <span class="math inline">\(\beta\)</span> values are <span class="math inline">\(y_i\)</span></li>
<li><strong>hardening</strong> predictions: better to leave as a probability?</li>
</ul>
</section>
<section id="consistency" class="level2">
<h2 class="anchored" data-anchor-id="consistency">consistency</h2>
<ul>
<li>if we want <em>consistency</em> we need (roughly) the number of observations used to make a prediction to grow (fast enough) with the total sample size <span class="math inline">\(N\)</span></li>
<li>doesn’t hold for fixed <span class="math inline">\(k\)</span></li>
<li>but will work if <span class="math inline">\(k/n \to 0\)</span> as <span class="math inline">\(k\to \infty, n \to \infty\)</span> (ADA)</li>
</ul>
</section>
<section id="from-nearest-to-k-nn" class="level2">
<h2 class="anchored" data-anchor-id="from-nearest-to-k-nn">from nearest to <span class="math inline">\(k\)</span>-NN</h2>
<ul>
<li>unlike (this version of) linear regression, complexity is adjustable</li>
<li>from “nearest neighbor” to “<span class="math inline">\(N\)</span>-n.n.” (i.e.&nbsp;the mean)</li>
<li>tuning parameter (<span class="math inline">\(k\)</span>) is <strong>discrete</strong> (e.g.&nbsp;awkward for optimization)</li>
</ul>
<p><strong>poll</strong>: what are some ways we can modify linear regression to have adjustable complexity?</p>
</section>
<section id="from-nn-to-kernel-smoothers-ada-esl-2.8.2" class="level2">
<h2 class="anchored" data-anchor-id="from-nn-to-kernel-smoothers-ada-esl-2.8.2">from NN to kernel smoothers (ADA, ESL 2.8.2)</h2>
<ul>
<li>kernel <strong>density estimation</strong> may be familiar</li>
<li>generalize “nearest neighbor” kernel</li>
<li>from ADA: <span class="math display">\[
\hat \mu(x) = \sum_i \left( \frac{K(x_i, x)}{\sum_j K(x_j, x)} \right) y_i
\]</span></li>
<li>or <span class="math inline">\(K(d(x_i,x)/h)\)</span> where <span class="math inline">\(h\)</span> is the <strong>bandwidth</strong></li>
<li>also not consistent unless we let <span class="math inline">\(h \to 0\)</span> and <span class="math inline">\(n \to \infty\)</span> (at the “right” rate)</li>
</ul>
</section>
<section id="dimensionality" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="dimensionality">dimensionality</h2>
<ul>
<li><strong>curse of dimensionality</strong></li>
<li>more points are near the edge of a set</li>
<li>more points are needed to “fill in”/characterize a density</li>
<li>the mode of a distribution is no longer “typical” in some sense<span class="citation" data-cites="gelmantypical2020">(<a href="#ref-gelmantypical2020" role="doc-biblioref">Gelman 2020</a>)</span></li>
<li>heuristic: surface to volume ratio of a <span class="math inline">\(p\)</span>-ball is <span class="math inline">\(p\)</span><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></li>
<li>results from ESL: distance from origin to nearest point (of <span class="math inline">\(N\)</span>) in dimension <span class="math inline">\(p\)</span> <span class="math display">\[
d(p,N) = \left(1- \frac{1}{2}^{1/N} \right)^{1/p}
\]</span></li>
<li>Bayesians: the mode is not “typical” <span class="citation" data-cites="gelmantypical2020">Gelman (<a href="#ref-gelmantypical2020" role="doc-biblioref">2020</a>)</span></li>
</ul>
<div class="no-row-height column-margin column-container"><div id="ref-gelmantypical2020" class="csl-entry" role="doc-biblioentry">
Gelman, Andrew. 2020. <span>“The Typical Set and Its Relevance to <span>Bayesian</span> Computation.”</span> <em>Statistical Modeling, Causal Inference, and Social Science</em>. https://statmodeling.stat.columbia.edu/2020/08/02/the-typical-set-and-its-relevance-to-bayesian-computation/.
</div><li id="fn1"><p><sup>1</sup>&nbsp;surprisingly slow!</p></li></div></section>
<section id="bias-variance-expansiontrade-off" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="bias-variance-expansiontrade-off">bias-variance expansion/trade-off</h2>
<ul>
<li>general expansion of <span class="math inline">\(E[(y-\hat \mu(x))^2]\)</span>, expanded as <span class="math display">\[
E[(\underbrace{(y-\mu(x))}_{\textrm{diff betw y, true RF}}+ \underbrace{(\mu(x)-\hat \mu(x)}_{\textrm{diff betw true RF, chosen approx}})^2
\]</span></li>
<li>take expectations, drop 0 terms <span class="math inline">\(\to\)</span> variance + bias<span class="math inline">\(^2\)</span></li>
<li>allow for variation across training sets, get <span class="math inline">\(\sigma^2 + \mathrm{var} + \mathrm{bias}^2\)</span> (ESL 2.47)</li>
<li>ADA example: true function (sine) is <em>worse than a constant function</em> for noisy data (Fig 1.3). cf. <span class="citation" data-cites="waltersEffects1981">Walters and Ludwig (<a href="#ref-waltersEffects1981" role="doc-biblioref">1981</a>)</span></li>
<li>bias <span class="math inline">\(\approx\)</span> <strong>within-sample</strong> error; easy to minimize</li>
</ul>
<div class="no-row-height column-margin column-container"><div id="ref-waltersEffects1981" class="csl-entry" role="doc-biblioentry">
Walters, Carl J., and Donald Ludwig. 1981. <span>“Effects of <span>Measurement Errors</span> on the <span>Assessment</span> of <span>Stock</span>–<span>Recruitment Relationships</span>.”</span> <em>Canadian Journal of Fisheries and Aquatic Sciences</em> 38 (6): 704–10. <a href="https://doi.org/10.1139/f81-093">https://doi.org/10.1139/f81-093</a>.
</div></div></section>
<section id="the-picture" class="level2">
<h2 class="anchored" data-anchor-id="the-picture">the picture</h2>
<p><img src="../pix/biasvar.png" class="img-fluid"></p>
<ul>
<li>want to find the ‘sweet spot’ with low computational effort, with minimal assumptions, and without snooping</li>
</ul>
</section>
<section id="effective-degrees-of-freedom" class="level2">
<h2 class="anchored" data-anchor-id="effective-degrees-of-freedom">effective degrees of freedom</h2>
<ul>
<li>may be able to compute a complexity measure, for simple cases</li>
<li>… such as linear weights</li>
<li><strong>trace of the hat matrix</strong>; ADA 1.66-1.68</li>
<li>related to ESL 2.28</li>
</ul>
</section>
<section id="references" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="references">references</h2>

</section>


</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>